var e=Object.defineProperty,n=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(n,t,r)=>t in n?e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,l=(e,n)=>{for(var t in n||(n={}))o.call(n,t)&&a(e,t,n[t]);if(r)for(var t of r(n))i.call(n,t)&&a(e,t,n[t]);return e},s=(e,r)=>n(e,t(r)),c=(e,n,t)=>new Promise(((r,o)=>{var i=e=>{try{l(t.next(e))}catch(n){o(n)}},a=e=>{try{l(t.throw(e))}catch(n){o(n)}},l=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,a);l((t=t.apply(e,n)).next())}));import{d,s as f}from"../assets/index-ClblwWOm.js";import"./chunk-BFAGzeFF.js";import"./chunk-COwh6yNZ.js";import"./chunk-BU7_rkh7.js";import"./chunk-CTAWNzGL.js";import"./chunk-D1HE5xNQ.js";const u=e=>c(void 0,null,(function*(){try{const n=[],t=[],r=[],o={company_name:e.companyName||"Nome não informado",business_segment:e.businessSegment||"Segmento não informado",company_description:e.businessDescription||"Descrição não informada",target_audience:e.targetAudience||"Público-alvo não informado",competitive_advantage:e.competitiveDifferential||"Diferencial não informado",landing_page_goal:e.landingPageGoal||"Objetivo não informado",responsible_name:e.responsibleName||"Responsável não informado",product_name:e.productName||"Produto não informado",product_description:e.productDescription||"Descrição do produto não informada",main_benefits:e.mainBenefits||"Benefícios não informados",call_to_action:e.callToAction||"CTA não informado",lead_destination:e.leadDestination||"Destino não informado",has_logo:e.hasLogo||"Não informado",domain_info:e.desiredDomain||"Domínio não informado",deadline:e.deliveryDeadline||"Prazo não informado",main_competitors:e.mainCompetitors||null,customer_pain_points:e.customerPainPoints||null,success_stories:e.successStories||null,social_proof:e.socialProof||null,current_website:e.currentWebsite||null,number_of_offers:e.numberOfOffers||null,offer_details:e.offerDetails||null,pricing_model:e.pricingModel||null,price_range:e.budget||null,guarantees:e.guarantees||null,target_results:e.targetResults||null,urgency_factors:e.urgencyFactors||null,objections:e.objections||null,landing_page_sections:e.landingPageSections||null,specific_requirements:e.specificRequirements||null,brand_colors:e.brandColors||null,brand_personality:e.brandPersonality||null,communication_tone:e.communicationTone||null,key_messages:e.keyMessages||null,logo_files:n.length>0?n:null,visual_references:e.visualReferences||null,visual_files:t.length>0?t:null,content_materials:e.contentMaterials||null,material_files:r.length>0?r:null,desired_domain:e.desiredDomain||null,integrations:e.integrations||null,analytics_tracking:e.analytics||null,start_date:e.startDate||null,budget:"Valor Acordado na Workana",additional_notes:e.additionalNotes||null};return yield((e,n=3,t=1e3)=>c(void 0,null,(function*(){for(let o=1;o<=n;o++)try{return yield e()}catch(r){if(o===n)throw r;yield new Promise((e=>setTimeout(e,t*o)))}throw new Error("Máximo de tentativas excedido")})))((()=>d(o)),3,2e3)}catch(n){throw Error,n}})),g=()=>c(void 0,null,(function*(){try{const{data:n,error:t}=yield f.from("client_briefings").select("*").order("created_at",{ascending:!1});if(t){return JSON.parse(localStorage.getItem("briefings")||"[]")}try{localStorage.setItem("briefings",JSON.stringify(n||[]))}catch(e){}return n||[]}catch(n){return JSON.parse(localStorage.getItem("briefings")||"[]")}})),m=(e,n)=>c(void 0,null,(function*(){try{const{data:r,error:o}=yield f.from("client_briefings").select("*").eq("id",e).single();if(o||!r){const t=JSON.parse(localStorage.getItem("briefings")||"[]"),r=t.findIndex((n=>n.id===e));if(-1===r)throw new Error(`Briefing com ID ${e} não encontrado`);return t[r]=s(l(l({},t[r]),n),{updated_at:(new Date).toISOString()}),localStorage.setItem("briefings",JSON.stringify(t)),t[r]}const{data:i,error:a}=yield f.from("client_briefings").update(s(l({},n),{updated_at:(new Date).toISOString()})).eq("id",e).select().single();if(a){const t=JSON.parse(localStorage.getItem("briefings")||"[]"),r=t.findIndex((n=>n.id===e));if(-1!==r)return t[r]=s(l(l({},t[r]),n),{updated_at:(new Date).toISOString()}),localStorage.setItem("briefings",JSON.stringify(t)),t[r];throw new Error("Falha ao atualizar briefing")}try{const n=JSON.parse(localStorage.getItem("briefings")||"[]"),t=n.findIndex((n=>n.id===e));-1!==t&&(n[t]=i,localStorage.setItem("briefings",JSON.stringify(n)))}catch(t){}return i}catch(r){throw r}})),p=e=>c(void 0,null,(function*(){try{const{data:t,error:r}=yield f.from("client_briefings").select("id, company_name").eq("id",e).single();if(r||!t){const n=JSON.parse(localStorage.getItem("briefings")||"[]"),t=n.length,r=n.filter((n=>n.id!==e));if(r.length===t)throw new Error(`Briefing com ID ${e} não encontrado para exclusão`);return void localStorage.setItem("briefings",JSON.stringify(r))}const{error:o,count:i}=yield f.from("client_briefings").delete({count:"exact"}).eq("id",e);if(o)throw new Error(`Erro do Supabase: ${o.message}`);if(0===i)throw new Error("Nenhum registro foi excluído");try{const n=JSON.parse(localStorage.getItem("briefings")||"[]").filter((n=>n.id!==e));localStorage.setItem("briefings",JSON.stringify(n))}catch(n){}}catch(t){try{const n=JSON.parse(localStorage.getItem("briefings")||"[]"),t=n.length,r=n.filter((n=>n.id!==e));if(r.length===t)throw new Error(`Briefing com ID ${e} não encontrado para exclusão`);localStorage.setItem("briefings",JSON.stringify(r))}catch(n){throw new Error("Falha ao excluir briefing")}}})),_=(e,n)=>c(void 0,null,(function*(){try{const t={proposal_value:n,proposal_date:(new Date).toISOString()};return yield m(e,t)}catch(t){throw t}}));export{_ as addProposalValue,p as deleteBriefing,g as getBriefings,u as submitBriefing,m as updateBriefing};
